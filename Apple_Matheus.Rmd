---
title: "Apple"
author: "Matheus Gomes"
date: "2025-02-24"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Mostrar o RStudio

colnames(dados) <- c("Data", "Ultimo", "Abertura", "Maxima", "Minima", "vol", "var")

# Explique qual o motivo para a escolha dessa base e explique os resultados esperados através da análise.

A base de dados escolhida contém informações sobre o preço das ações da Apple Inc. (AAPL) no período de 01/01/2020 a 01/01/2025. A escolha dessa empresa e desse intervalo se justifica pelo fato de a Apple ser uma das maiores companhias do mundo, altamente negociada no mercado financeiro, além de ser uma referência no setor de tecnologia, será analisado o preço das ações ao longo do tempo, a volatidade do ativo e a relação do volume de negocição e a oscilação de preços.

# Carregar a base de dados
# Mostrar o RStudio

colnames(dados) <- c("Data", "Ultimo", "Abertura", "Maxima", "Minima", "vol.", "var.")

# Explique qual o motivo para a escolha dessa base e explique os resultados esperados através da análise.

## A base de dados escolhida contém informações sobre o preço das ações da Apple Inc. (AAPL) no período de 01/01/2020 a 01/01/2025. A escolha dessa empresa e desse intervalo se justifica pelo fato de a Apple ser uma das maiores companhias do mundo, altamente negociada no mercado financeiro, além de ser uma referência no setor de tecnologia, será analisado o preço das ações ao longo do tempo, a volatidade do ativo e a relação do volume de negocição e a oscilação de preços.

# Carregar a base de dados
```{r Carregando base de dados e carregando pacotes, echo = TRUE}


dados <- read.csv("apple.csv")

# Instalar e carregar pacotes
library(tidyverse)

library(ggplot2)

library(summarytools)


library(tinytex)


# Outros pacotes necessários

library(lubridate)

library(pacman)
```

# Aplique uma função em R que seja útil para sua análise e mostre

Nessa parte eu fiz a correção dos dados, acertando as datas, nomes, e os valores.

```{r Aplicando funções R, echo = TRUE}

## Apliquei funções para efetuar correções como datas, e valores.

colnames(dados) <- c("Data", "Ultimo", "Abertura", "Maxima", "Minima", "Vol.", "Var.")

dados$Data <- as.Date(dados$Data, format = "%d.%m.%Y")

dados[, 2:7] <- lapply(dados[, 2:7], function(x) as.numeric(gsub(",", ".", x)))

dados$Vol. <- gsub("B", "e9", dados$Vol.)

dados$Vol. <- gsub("M", "e6", dados$Vol.)

dados$Vol. <- as.numeric(gsub(",", ".", dados$Vol.))

dados$Var. <- gsub("%", "", dados$Var.)

dados$Var. <- as.numeric(gsub(",", ".", dados$Var.)) / 100

data <- as.Date(dados$Data, format = "%Y-%m-%d")
```

# Escolher variável e fazer média,dp,quantis 25% e 75%

Fiz calculos de desvio padrão, média e quantis, com a váriavel Último da Apple.

```{r Média,dp,quantis, echo = TRUE}
media_ultimo <- mean(dados$Último, na.rm = TRUE) 

desvio_padrao_ultimo <- sd(dados$Último, na.rm =  TRUE)

quantis_ultimo <- quantile(dados$Último, probs = c(0.25,0.75), na.rm = TRUE)

print(media_ultimo)
print(desvio_padrao_ultimo)
print(quantis_ultimo)
```

# Usando a função descr


Usei o descr para avaliar as estatísticas descritivas de variáveis numérticas e catégoricas

```{r Função descr, echo = TRUE}
descr(dados)
```        

# Criando histograma

Usei 10 bins pois foi uma escolha mais razoável para vizualizar a distribuição.
Não se aproxima de uma distribuição normal, pois ela é assimétrica e possui uma calda maior, isso pode indicar um outlier e uma influência que pode mudar o preço da ação.


```{r grafico_1, echo = TRUE}
ggplot(data = dados, aes(x = Ultimo)) +
  geom_histogram(binwidth = 10, fill = "blue", color = "black") +
  labs(title = "Histograma de Preço de Fechamento da Apple",
       x = "Preço de Fechamento (Último)",
       y = "Frequência") +
  theme_minimal()
```

  
# Calcular a correlação entre todas as variaveis, e mostrar as 3 váriaveis mais correlacionadas

Nessa parte calculei a correlação entre as variaveis e mostrei as 3 váriaveis que tinham mais correlação entre elas

```{r Função  correlacao, echo = TRUE}
dados_selecionados <- dados[, c("Ultimo", "Abertura", "Maxima", "Minima", "Vol.", "Var.")]

correlacao <- cor(dados_selecionados)

correlacao_df <- as.data.frame(as.table(correlacao))

correlacao_df <- correlacao_df[correlacao_df$Var1 != correlacao_df$Var2, ]

correlacao_df <- correlacao_df[order(abs(correlacao_df$Freq), decreasing = TRUE), ]

top3_pares <- correlacao_df[!duplicated(t(apply(correlacao_df[,1:2],
1, sort))),][1:3, ]

print(top3_pares)
```


# Criar um scatterplot

```{r grafico_2, echo = TRUE}
ggplot(dados, aes(x = Minima, y = Maxima)) +
  geom_point(aes(color = "Pontos"), alpha = 0.5) +  
  geom_smooth(aes(color = "Regressao"), method = "lm", se = FALSE) +  
  scale_color_manual(
    name = "Dados da Apple",
    values = c("Pontos" = "blue", "Regressao" = "red"),
    labels = c("Pontos" = "Dados observáveis", "Regressao" = "Estimativa de Regressão Linear")
  ) +
  labs(
    title = "Relação entre Máxima e Mínima",
    x = "Mínima",
    y = "Máxima"
  ) +
  theme_classic()
```

# Criar um gráfico de linha.

```{r grafico 3, echo = TRUE}
ggplot(dados, aes(x = 1:nrow(dados))) +
  geom_line(aes(y = Maxima, color = "Máxima"), size = 1) + 
  geom_line(aes(y = Minima, color = "Mínima"), size = 1) +
  scale_color_manual(name = "Legenda", values = c("Máxima" = "blue", "Mínima" = "red")) +
  labs(title = "Comparação entre Máxima e Mínima",
       x = "Observações",
       y = "Valor") +
  theme_classic()
``` 